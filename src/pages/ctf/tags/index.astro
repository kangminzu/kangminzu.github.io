---
import Breadcrumbs from '@/components/Breadcrumbs.astro'
import PageHead from '@/components/PageHead.astro'
import Layout from '@/layouts/Layout.astro'
import { getAllTagsForCollection } from '@/lib/data-utils'
import { Badge } from '@/components/ui/badge'

const tags = await getAllTagsForCollection('ctf')
const sortedTags = Array.from(tags.entries()).sort((a, b) =>
  a[0].localeCompare(b[0]),
)
---

<Layout class="max-w-3xl">
  <PageHead
    slot="head"
    title="CTF Tags"
    description="Browse CTF posts by tag."
    noindex
  />
  <Breadcrumbs
    items={[
      { href: '/ctf', label: 'CTF', icon: 'lucide:flag' },
      { label: 'Tags', icon: 'lucide:tags' },
    ]}
  />

  <div class="flex flex-wrap gap-2">
    {
      sortedTags.map(([tag, count]) => (
        <a
          href={`/ctf/tags/${encodeURIComponent(tag)}`}
          class="inline-flex items-center gap-2"
        >
          <Badge variant="muted">
            {tag}
          </Badge>
          <span class="text-muted-foreground text-xs">{count}</span>
        </a>
      ))
    }
  </div>
</Layout>
