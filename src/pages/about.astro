---
import AuthorCard from '@/components/AuthorCard.astro'
import Breadcrumbs from '@/components/Breadcrumbs.astro'
import PageHead from '@/components/PageHead.astro'
import ProjectCard from '@/components/ProjectCard.astro'
import Layout from '@/layouts/Layout.astro'
import {
  getAllAuthors,
  getAllCtfProjects,
  getAllProjects,
} from '@/lib/data-utils'

const authors = await getAllAuthors()
const ctfProjects = await getAllCtfProjects()
const projects = await getAllProjects()
const ctfPreview = ctfProjects.slice(0, 2)
const ctfRest = ctfProjects.slice(2)
const projectPreview = projects.slice(0, 2)
const projectRest = projects.slice(2)
---

<Layout class="max-w-3xl">
  <PageHead slot="head" title="About" />
  <Breadcrumbs items={[{ label: 'About', icon: 'lucide:info' }]} />

  <section>
    <div class="min-w-full">
      <h2 class="mb-4 text-2xl font-medium">Author</h2>
      <div class="mb-10 flex flex-col gap-4">
        {authors.map((author) => <AuthorCard author={author} />)}
      </div>

      <div class="prose mb-8">
        <dl class="grid grid-cols-[7rem_1fr] gap-x-4 gap-y-2">
          <dt class="text-muted-foreground">Focus</dt>
          <dd>
            <div class="flex flex-wrap gap-2">
              <span class="rounded-full border px-2 py-0.5 text-xs">Windows Pwnable</span>
              <span class="rounded-full border px-2 py-0.5 text-xs">Reverse Engineering</span>
            </div>
          </dd>

          <dt class="text-muted-foreground">Interests</dt>
          <dd>
            <div class="flex flex-wrap gap-2">
              <span class="rounded-full border px-2 py-0.5 text-xs">Windows</span>
              <span class="rounded-full border px-2 py-0.5 text-xs">Windows Kernel</span>
            </div>
          </dd>

          <dt class="text-muted-foreground">Language</dt>
          <dd>
            <div class="flex flex-wrap gap-2">
              <span class="rounded-full border px-2 py-0.5 text-xs">Korean — Native</span>
              <span class="rounded-full border px-2 py-0.5 text-xs">English — Bilingual</span>
            </div>
          </dd>

          <dt class="text-muted-foreground">Location</dt>
          <dd>
            <div class="flex flex-wrap gap-2">
              <span class="rounded-full border px-2 py-0.5 text-xs">Soeul</span>
              <span class="rounded-full border px-2 py-0.5 text-xs">Incheon</span>
              <span class="rounded-full border px-2 py-0.5 text-xs">Remote</span>
            </div>
          </dd>

          <dt class="text-muted-foreground">Contact</dt>
          <dd>
            <div class="flex flex-wrap gap-2">
              <span class="rounded-full border px-2 py-0.5 text-xs">minzu4012@gmail.com</span>
              <span class="rounded-full border px-2 py-0.5 text-xs">Discord: min._.zu</span>
            </div>
          </dd>
        </dl>
      </div>

      <div class="flex flex-col gap-10">
        <section>
          <div class="mb-4 flex items-center justify-between">
            <h2 class="text-2xl font-medium">CTF</h2>
          </div>
          <div class="flex flex-col gap-4">
            {ctfPreview.map((project) => (
              <ProjectCard project={project} />
            ))}
            {
              ctfRest.length > 0 && (
                <details class="rounded-lg border">
                  <summary class="cursor-pointer px-4 py-3 text-sm font-medium">
                    View more
                  </summary>
                  <div class="flex flex-col gap-4 px-4 pb-4">
                    {ctfRest.map((project) => (
                      <ProjectCard project={project} />
                    ))}
                  </div>
                </details>
              )
            }
          </div>
        </section>

        <section>
          <div class="mb-4 flex items-center justify-between">
            <h2 class="text-2xl font-medium">PROJECT</h2>
          </div>
          <div class="flex flex-col gap-4">
            {projectPreview.map((project) => (
              <ProjectCard project={project} />
            ))}
            {
              projectRest.length > 0 && (
                <details class="rounded-lg border">
                  <summary class="cursor-pointer px-4 py-3 text-sm font-medium">
                    View more
                  </summary>
                  <div class="flex flex-col gap-4 px-4 pb-4">
                    {projectRest.map((project) => (
                      <ProjectCard project={project} />
                    ))}
                  </div>
                </details>
              )
            }
          </div>
        </section>
      </div>
    </div>
  </section>
</Layout>
